<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Norwegian institute for nature research">
<meta name="dcterms.date" content="2024-09-18">

<title>Survey123 plot data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Script_S123_rutedata_files/libs/clipboard/clipboard.min.js"></script>
<script src="Script_S123_rutedata_files/libs/quarto-html/quarto.js"></script>
<script src="Script_S123_rutedata_files/libs/quarto-html/popper.min.js"></script>
<script src="Script_S123_rutedata_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Script_S123_rutedata_files/libs/quarto-html/anchor.min.js"></script>
<link href="Script_S123_rutedata_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Script_S123_rutedata_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Script_S123_rutedata_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Script_S123_rutedata_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Script_S123_rutedata_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Survey123 plot data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Norwegian institute for nature research </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 18, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>This script converts data imported from Survey123 into the format used in the masterfile: Herminium_monorchis_masterfile_v_2024.</p>
<p>Before getting started, we can run this line to make sure R can read Norwegian letters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="at">locale=</span><span class="st">'no_NB.utf8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LC_COLLATE=no_NB.utf8;LC_CTYPE=no_NB.utf8;LC_MONETARY=no_NB.utf8;LC_NUMERIC=C;LC_TIME=no_NB.utf8"</code></pre>
</div>
</div>
<p>First, we need to load the required packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(goeveg)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#NB use install.packages("package name") if the package is not installed yet.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Using qmd requires the "rmarkdown" package installed.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can import the raw data from Survey123.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"P:/154027_effektovervaking_av_trua_arter_og_naturtyper_2024/04 Honningblom/Herminium monorchis/Data/S123_ruter_rawdata_02.08.2024.xlsx"</span>, <span class="at">sheet=</span><span class="st">'surveyPoint_0'</span>)<span class="co">#loads date from the normal fields. </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"P:/154027_effektovervaking_av_trua_arter_og_naturtyper_2024/04 Honningblom/Herminium monorchis/Data/S123_ruter_rawdata_02.08.2024.xlsx"</span>, <span class="at">sheet=</span><span class="st">'art_1'</span>)<span class="co">#loads data with species registration. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The job at hand is to combine these two datasets, and create one dataset that we can analyze in R.</p>
<p>The column named ParentGlobalID in the species data matches with GlobalID in the env data. GlobalID in the species data is a unique identifier in that dataset, and we do not need it at this point. We can thus use GlovalID (env) and ParentGlobalID (species) as identifiers to merge the data. We can call it ParentGlobalID in both datasets for ease of joining. Multiple rows of data per GlobalParent may be created (e.g., multiple species per GlobalParentID).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First we need to fix the plot names</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> env <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tidyr<span class="sc">::</span><span class="fu">separate</span>(<span class="st">"Rute-ID"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Locality_ID"</span>, <span class="st">"Plot_number"</span>), <span class="st">"(?&lt;=[A-Z])(?=[0-9])"</span>, <span class="at">fill =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span> <span class="co">#separates existing Rute-ID into the the locality identifier and plot number, fill = "left" is needed because some of the left (the locality identifiers) arguments are missing.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">Locality_ID =</span> <span class="fu">if_else</span>(<span class="st">`</span><span class="at">Polygon ID</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Filletassen"</span>, <span class="st">"FI"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">if_else</span>(<span class="st">`</span><span class="at">Polygon ID</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Skipstadsand"</span>, <span class="st">"SKI"</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">if_else</span>(<span class="st">`</span><span class="at">Polygon ID</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Skjellvik"</span>, <span class="st">"SKJ"</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">if_else</span>(<span class="st">`</span><span class="at">Polygon ID</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Teneskjær"</span>, <span class="st">"TEN"</span>, <span class="cn">NA</span>))))) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unite</span>(Plot_ID_new, Locality_ID<span class="sc">:</span>Plot_number, <span class="at">sep =</span> <span class="st">""</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)  <span class="co">#creates new Plot_ID like we want it :)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we can rename the GlobalID so we can join the datafiles</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> env <span class="sc">%&gt;%</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ParentGlobalID =</span> GlobalID)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Join the species dataset to the environmental dataset</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>df_plot_plants <span class="ot">&lt;-</span> env <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(species, <span class="at">by =</span> <span class="st">"ParentGlobalID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have a datafile with a lot of columns we do not need. To match the master datafile for Herminium monorchis, we only need:</p>
<ul>
<li>Date (date of registration)</li>
<li>Locality (full locality name)</li>
<li>Locality_ID (abbreviation for the locality)</li>
<li>Plot_ID (plot number)</li>
<li>Plot_ID_new (consists of the locality ID and plot number)</li>
<li>Species_norwegian (norwegian species name)</li>
<li>Presence_quadrat (the quadrats the species is registered in, formatted as #,#,#,etc)</li>
<li>Quadrats (the number of quadrats the species is present in - this one does not exist in the S123 data, so needs to be created later)</li>
<li>Cover_vascular.plants<br>
</li>
<li>Cover_DOM<br>
</li>
<li>Cover_bare.soil (we do not have this on in S123)</li>
<li>Cover_bryophytes<br>
</li>
<li>Cover_woody_fieldlayer</li>
<li>Cover_shrubs</li>
<li>Height_1<br>
</li>
<li>Height_2<br>
</li>
<li>Height_3<br>
</li>
<li>Height_4</li>
<li>Comments (any comments to species registrations)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_plot_plants <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Registreringsdato:</span><span class="st">`</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Polygon ID.x</span><span class="st">`</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         Locality_ID, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         Plot_number, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         Plot_ID_new, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         sp_species, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Smårutene nr.</span><span class="st">`</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Kommentarer:...10</span><span class="st">`</span>, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Kommentarer:...11</span><span class="st">`</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Kommentarer:...18</span><span class="st">`</span>, </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Kommentarer:...29</span><span class="st">`</span>, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Dekning % av karplanter i feltsjikt</span><span class="st">`</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Dekning % av strø</span><span class="st">`</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Dekning % av bunnsjikt</span><span class="st">`</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Dekning % av vedplanter i feltsjikt</span><span class="st">`</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Dekning % av vedplanter i busksjikt</span><span class="st">`</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Vegetasjonshøyde måling 1</span><span class="st">`</span>, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Vegetasjonshøyde måling 2</span><span class="st">`</span>, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Vegetasjonshøyde måling 3</span><span class="st">`</span>, </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Vegetasjonshøyde måling 4</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 267 × 20
   `Registreringsdato:` `Polygon ID.x` Locality_ID Plot_number Plot_ID_new
   &lt;dttm&gt;               &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;      
 1 2024-07-22 10:00:00  Skipstadsand   SKI         13          SKI13      
 2 2024-07-22 10:00:00  Skipstadsand   SKI         2           SKI2       
 3 2024-07-22 10:00:00  Skipstadsand   SKI         14          SKI14      
 4 2024-07-22 10:00:00  Skipstadsand   SKI         9           SKI9       
 5 2024-07-22 10:00:00  Skipstadsand   SKI         4           SKI4       
 6 2024-07-22 10:00:00  Skipstadsand   SKI         6           SKI6       
 7 2024-07-22 10:00:00  Skipstadsand   SKI         3           SKI3       
 8 2024-07-22 10:00:00  Skipstadsand   SKI         7           SKI7       
 9 2024-07-22 10:00:00  Skipstadsand   SKI         8           SKI8       
10 2024-07-23 10:00:00  Filletassen    FI          1           FI1        
# ℹ 257 more rows
# ℹ 15 more variables: sp_species &lt;chr&gt;, `Smårutene nr.` &lt;chr&gt;,
#   `Kommentarer:...10` &lt;chr&gt;, `Kommentarer:...11` &lt;lgl&gt;,
#   `Kommentarer:...18` &lt;chr&gt;, `Kommentarer:...29` &lt;chr&gt;,
#   `Dekning % av karplanter i feltsjikt` &lt;dbl&gt;, `Dekning % av strø` &lt;dbl&gt;,
#   `Dekning % av bunnsjikt` &lt;dbl&gt;,
#   `Dekning % av vedplanter i feltsjikt` &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What about the total plant cover?</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Cover_vascular.plants  Cover_DOM   Cover_bare.soil Cover_bryophytes    Height_1    Height_2    Height_3    Height_4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ruteregistreringer for Honningblom må fjernes når det er en observasjon i rute 1 men tellingen i rute 1 viser 0 individer</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>